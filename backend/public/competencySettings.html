<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@400;500;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #F8F9FA;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            min-height: 100vh;
            position: relative;
            background: white;
            display: flex;
        }

        .main-content {
            flex: 1;
            margin-left: 0;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            width: 100%;
            height: 76px;
            padding: 16px 32px;
            background: white;
            backdrop-filter: blur(32px);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .header-content {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-box {
            padding: 4px 16px;
            background: white;
            border-radius: 4px;
            outline: 1px #E9ECEF solid;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            gap: 8px;
        }

        .search-icon {
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .search-text {
            width: 240px;
            color: #ADB5BD;
            font-size: 16px;
            font-family: Inter;
            font-weight: 400;
            line-height: 28px;
        }

        .search-input {
            width: 240px;
            border: none;
            outline: none;
            background: transparent;
            color: #232D42;
            font-size: 16px;
            font-family: Inter;
            font-weight: 400;
            line-height: 28px;
        }

        .search-input::placeholder {
            color: #ADB5BD;
        }

        .header-right {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 16px;
        }

        .notification-icon {
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .user-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            cursor: pointer;
        }

        .user-details {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
        }

        .user-name {
            color: #232D42;
            font-size: 16px;
            font-family: Inter;
            font-weight: 400;
            line-height: 28px;
        }

        .user-role {
            color: #8A92A6;
            font-size: 13px;
            font-family: Inter;
            font-weight: 400;
            line-height: 16.90px;
        }

        .page-title {
            width: 100%;
            height: 75px;
            background: radial-gradient(ellipse 150.93% 36.28% at 50.00% 50.00%, #3B8AFF 0%, #0048B2 100%);
            border-bottom-right-radius: 16px;
            border-bottom-left-radius: 16px;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 0 32px;
            margin-left: 10px;
        }

        .title-content {
            width: 100%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }

        .title-text {
            color: white;
            font-size: 30px;
            font-family: Inter;
            font-weight: 700;
        }

        .content {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .results-table {
            width: 100%;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border-collapse: collapse;
        }

        .results-table th,
        .results-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid #E9ECEF;
        }

        .results-table th {
            background: #F8F9FA;
            color: #232D42;
            font-size: 14px;
            font-family: Montserrat;
            font-weight: 700;
        }

        .results-table td {
            color: #232D42;
            font-size: 14px;
            font-family: Montserrat;
            font-weight: 500;
        }

        .results-table tr:hover {
            background: rgba(2, 134, 247, 0.10);
        }

        .results-table tr.inactive {
            background-color: #f8f9fa;
            color: #adb5bd;
        }

        .results-table tr.inactive td {
            color: #adb5bd;
        }

        .results-table tr.inactive .status-badge {
            opacity: 0.8;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .action-button {
            cursor: pointer;
        }

        /* Sayfalama Stilleri */
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .pagination-info {
            color: #6C757D;
            font-size: 14px;
            font-weight: 500;
            margin-right: 16px;
        }

        .page-nav {
            padding: 8px 12px;
            background: white;
            border: 1px solid #DEE2E6;
            border-radius: 6px;
            cursor: pointer;
            color: #495057;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 40px;
            height: 40px;
        }

        .page-nav:hover:not(.disabled) {
            background: #E9ECEF;
            border-color: #ADB5BD;
            color: #495057;
        }

        .page-nav.disabled {
            background: #F8F9FA;
            border-color: #E9ECEF;
            color: #ADB5BD;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .page-button {
            padding: 8px 12px;
            background: white;
            border: 1px solid #DEE2E6;
            border-radius: 6px;
            cursor: pointer;
            color: #495057;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 40px;
            height: 40px;
        }

        .page-button:hover:not(.active) {
            background: #E9ECEF;
            border-color: #ADB5BD;
            color: #495057;
        }

        .page-button.active {
            background: #0286F7;
            color: white;
            border-color: #0286F7;
            box-shadow: 0 2px 4px rgba(2, 134, 247, 0.2);
        }

        .page-button.active:hover {
            background: #0275D8;
            border-color: #0275D8;
        }

        .page-ellipsis {
            padding: 8px 4px;
            color: #6C757D;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 40px;
            height: 40px;
        }

        @media (max-width: 768px) {
            .pagination-container {
                gap: 4px;
            }
            
            .pagination-info {
                margin-right: 8px;
                font-size: 12px;
            }
            
            .page-nav, .page-button {
                min-width: 36px;
                height: 36px;
                font-size: 12px;
                padding: 6px 8px;
            }
        }


        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .işleniyor {
            background-color: #FFD700;
            color: #000;
        }

        .yellow {
            background-color: #FFD700;
            color: #000;
        }

        .green {
            background-color: #00FF00;
            color: #000;
        }

        .red {
            background-color: #FF0000;
            color: #FFF;
        }

        .süresi-doldu {
            background-color: #F8D7DA;
            color: #721C24;
        }

        .score-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }


        .expired-warning {
            color: #dc3545;
            font-size: 14px;
            margin-left: 8px;
            cursor: help;
        }

        .expired-warning i {
            color: #dc3545;
        }

        /* Loading spinner */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0286F7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Gruplandırma stilleri */
        .expand-icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            line-height: 18px;
            text-align: center;
            background: #0286F7;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            margin-right: 8px;
            transition: background-color 0.3s;
        }

        .expand-icon:hover {
            background: #0275D8;
        }

        .group-count {
            color: #666;
            font-size: 12px;
            margin-left: 8px;
        }

        .sub-row {
            background: #f8f9fa;
        }

        .sub-row.hidden {
            display: none;
        }

        .grouped-row {
            background: #e3f2fd;
        }

        /* Yetkinlik Ekleme Popup Stilleri */
        .competency-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .competency-popup-content {
            width: 100%;
            max-width: 600px;
            height: auto;
            padding: 30px 35px;
            position: relative;
            background: white;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .competency-popup-title-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 13px;
        }

        .competency-popup-title {
            text-align: center;
            color: black;
            font-size: 20px;
            font-family: Inter;
            font-weight: 700;
        }

        .competency-popup-title-line {
            width: 44px;
            height: 3px;
            background: black;
            border-radius: 29px;
        }

        .competency-popup-form {
            width: 100%;
            padding: 19px 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 15px;
        }

        .competency-input-group {
            width: 100%;
            height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 8px;
        }

        .competency-input-label {
            color: #8A92A6;
            font-size: 16px;
            font-family: Inter;
            font-weight: 400;
            line-height: 28px;
        }

        .competency-input-row {
            display: flex;
            gap: 15px;
            width: 100%;
        }

        .competency-input-field {
            flex: 1;
            padding: 8px 16px;
            background: white;
            border-radius: 4px;
            outline: 1px #3A57E8 solid;
            outline-offset: -1px;
            color: black;
            font-family: Inter;
            font-weight: 500;
            font-size: 16px;
            line-height: 28px;
        }

        .competency-popup-buttons {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 15px;
        }

        .competency-cancel-button {
            width: 143px;
            height: 48px;
            padding: 14px 20px;
            background: white;
            border-radius: 8px;
            outline: 1px #E02D3C solid;
            outline-offset: -1px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .competency-cancel-text {
            color: #E02D3C;
            font-size: 16px;
            font-weight: 500;
        }

        .competency-save-button {
            width: 145px;
            height: 46px;
            padding: 8px 12px;
            background: #0286F7;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .competency-save-text {
            color: white;
            font-family: Inter;
            font-size: 14px;
            font-weight: 700;
        }

        .competency-popup-close {
            width: 24px;
            height: 24px;
            padding: 4px;
            position: absolute;
            right: 13px;
            top: 13px;
            background: #E5E5E5;
            border-radius: 29px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .competency-popup-close-icon {
            width: 10px;
            height: 10px;
        }

        /* Popup üzerinde mesaj gösterme */
        .competency-message {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            z-index: 1001;
            animation: slideDown 0.3s ease-out;
        }

        .competency-message.success {
            background: #D4EDDA;
            color: #155724;
            border: 1px solid #C3E6CB;
        }

        .competency-message.error {
            background: #F8D7DA;
            color: #721C24;
            border: 1px solid #F5C6CB;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Tablo üstü butonları */
        .btn-add, .btn-edit, .btn-delete {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-add {
            background: #28A745;
            color: white;
        }

        .btn-add:hover {
            background: #218838;
        }

        .btn-import {
            background: #28A745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-import:hover {
            background: #218838;
        }

        .btn-edit {
            background: #17A2B8;
            color: white;
        }

        .btn-edit:hover {
            background: #138496;
        }

        .btn-delete {
            background: #DC3545;
            color: white;
        }

        .btn-delete:hover {
            background: #C82333;
        }

        .btn-add i, .btn-import i, .btn-edit i, .btn-delete i {
            font-size: 14px;
        }

        /* Disabled buton stilleri */
        .btn-edit:disabled, .btn-delete:disabled {
            background: #6C757D;
            color: #ADB5BD;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .btn-edit:disabled:hover, .btn-delete:disabled:hover {
            background: #6C757D;
        }

        /* Silme Popup Stilleri */
        .delete-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .delete-popup-content {
            width: 400px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .delete-popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #0286F7;
        }

        .delete-popup-title {
            color: #0286F7;
            font-size: 20px;
            font-weight: 700;
        }

        .delete-popup-close {
            cursor: pointer;
            font-size: 24px;
            color: #666;
        }

        .delete-popup-body {
            padding: 20px 0;
            text-align: center;
        }

        .delete-popup-body p {
            margin: 10px 0;
            color: #232D42;
            font-size: 16px;
        }

        .delete-warning {
            color: #dc3545 !important;
            font-weight: 500;
        }

        .delete-popup-footer {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding-top: 20px;
        }

        .btn-cancel {
            background: #6C757D;
            color: white;
            border: none;
            padding: 8px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-confirm {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-cancel:hover {
            background: #5A6268;
        }

        .btn-confirm:hover {
            background: #c82333;
        }

        /* Import Popup Stilleri */
        .import-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .import-popup-content {
            width: 500px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .import-popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #0286F7;
        }

        .import-popup-title {
            color: #0286F7;
            font-size: 20px;
            font-weight: 700;
        }

        .import-popup-close {
            cursor: pointer;
            font-size: 24px;
            color: #666;
        }

        .import-popup-body {
            padding: 20px 0;
        }

        .file-upload-area {
            border: 2px dashed #0286F7;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-area:hover {
            background: #e3f2fd;
            border-color: #0275D8;
        }

        .file-upload-area.dragover {
            background: #e3f2fd;
            border-color: #0275D8;
        }

        .file-upload-icon {
            font-size: 48px;
            color: #0286F7;
            margin-bottom: 16px;
        }

        .file-upload-text {
            color: #232D42;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .file-upload-subtext {
            color: #6C757D;
            font-size: 14px;
        }

        .file-input {
            display: none;
        }

        .selected-file {
            background: #D4EDDA;
            border: 1px solid #C3E6CB;
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .file-icon {
            color: #28A745;
            font-size: 24px;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-weight: 500;
            color: #155724;
        }

        .file-size {
            font-size: 12px;
            color: #6C757D;
        }

        .remove-file {
            color: #DC3545;
            cursor: pointer;
            font-size: 18px;
        }

        .import-popup-footer {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding-top: 20px;
        }

        .btn-import-excel {
            background: #28A745;
            color: white;
            border: none;
            padding: 8px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-import-excel:hover {
            background: #218838;
        }

        .btn-import-excel:disabled {
            background: #6C757D;
            cursor: not-allowed;
        }

        #importMessage {
            white-space: pre-line;
            max-height: 200px;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.4;
        }

        /* Modern Checkbox Stilleri */
        .custom-checkbox {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        .custom-checkbox input[type="checkbox"] {
            opacity: 0;
            position: absolute;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: relative;
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: #fff;
            border: 2px solid #E9ECEF;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .custom-checkbox:hover .checkmark {
            border-color: #0286F7;
            box-shadow: 0 0 0 3px rgba(2, 134, 247, 0.1);
        }

        .custom-checkbox input[type="checkbox"]:checked ~ .checkmark {
            background-color: #0286F7;
            border-color: #0286F7;
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
            left: 4px;
            top: 1px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(40deg);
        }

        .custom-checkbox input[type="checkbox"]:checked ~ .checkmark:after {
            display: block;
        }

        .custom-checkbox input[type="checkbox"]:checked ~ .checkmark {
            animation: checkmarkAnimation 0.3s ease;
        }

        @keyframes checkmarkAnimation {
            0% {
                transform: scale(0.8);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <div class="header">
                <div class="header-content">
                    <div class="header-right">
                        <div class="notification-icon">
                            <i class="fas fa-bell" style="color: #8A92A6;"></i>
                        </div>
                        <div class="user-info">
                            <div class="user-details">
                                <div class="user-name">Andron Games</div>
                                <div class="user-role">Founder</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-title">
                <div class="title-content">
                    <div class="title-text">Yetkinlik Ayarları</div>
                </div>
            </div>

            <div class="content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <div class="search-box">
                        <div class="search-icon">
                            <i class="fas fa-search" style="color: #ADB5BD;"></i>
                        </div>
                        <input type="text" id="searchInput" class="search-input" placeholder="Arama yapın...">
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button class="btn-add" onclick="addItem()">
                            <i class="fas fa-plus"></i> Ekle
                        </button>
                        <button class="btn-import" onclick="openImportPopup()">
                            <i class="fas fa-file-excel"></i> Import
                        </button>
                        <button class="btn-edit" id="editBtn" onclick="editItem()" disabled>
                            <i class="fas fa-edit"></i> Düzenle
                        </button>
                        <button class="btn-delete" id="deleteBtn" onclick="deleteItem()" disabled>
                            <i class="fas fa-trash"></i> Sil
                        </button>
                    </div>
                </div>
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Seçim</th>
                            <th>Unvan</th>
                            <th>Müşteri Odaklılık</th>
                            <th>Belirsizlik Yönetimi</th>                     
                            <th>İnsanları Etkileme</th>
                            <th>Güven Veren İşbirlikçi ve Sinerji</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                        <!-- Veriler JavaScript ile doldurulacak -->
                    </tbody>
                </table>
                <div class="pagination-container">
                    <!-- Sayfalama içeriği JavaScript ile doldurulacak -->
                </div>
            </div>

                    </div>
                        </div>

    <!-- Yetkinlik Ekleme Popup -->
    <div class="competency-popup" id="competencyPopup">
        <div class="competency-popup-content">
            <!-- Mesaj alanı -->
            <div id="competencyMessage" class="competency-message" style="display: none;"></div>
            
            <div class="competency-popup-title-container">
                <div class="competency-popup-title">Yetkinlik Ekle</div>
                <div class="competency-popup-title-line"></div>
                        </div>
            
            <div class="competency-popup-form">
                <div class="competency-input-group">
                    <div class="competency-input-label">Unvan</div>
                    <input type="text" class="competency-input-field" id="titleInput" placeholder="Unvan giriniz" style="width: 100%;">
                        </div>
                
                <div class="competency-input-group">
                    <div class="competency-input-label">Müşteri Odaklılık</div>
                    <div class="competency-input-row">
                        <input type="number" class="competency-input-field" id="customerFocusMin" placeholder="Minimum" min="0" max="100">
                        <input type="number" class="competency-input-field" id="customerFocusMax" placeholder="Maksimum" min="0" max="100">
                        </div>
                        </div>
                
                <div class="competency-input-group">
                    <div class="competency-input-label">Belirsizlik Yönetimi</div>
                    <div class="competency-input-row">
                        <input type="number" class="competency-input-field" id="uncertaintyMin" placeholder="Minimum" min="0" max="100">
                        <input type="number" class="competency-input-field" id="uncertaintyMax" placeholder="Maksimum" min="0" max="100">
                    </div>
                    </div>
                
                <div class="competency-input-group">
                    <div class="competency-input-label">İnsanları Etkileme</div>
                    <div class="competency-input-row">
                        <input type="number" class="competency-input-field" id="influenceMin" placeholder="Minimum" min="0" max="100">
                        <input type="number" class="competency-input-field" id="influenceMax" placeholder="Maksimum" min="0" max="100">
                </div>
            </div>

                <div class="competency-input-group">
                    <div class="competency-input-label">Güven Veren İşbirlikçi ve Sinerji</div>
                    <div class="competency-input-row">
                        <input type="number" class="competency-input-field" id="collaborationMin" placeholder="Minimum" min="0" max="100">
                        <input type="number" class="competency-input-field" id="collaborationMax" placeholder="Maksimum" min="0" max="100">
                    </div>
                </div>
            </div>

            <div class="competency-popup-buttons">
                <div class="competency-cancel-button" onclick="closeCompetencyPopup()">
                    <div class="competency-cancel-text">İptal</div>
                    </div>
                <div class="competency-save-button" onclick="saveCompetency()">
                    <div class="competency-save-text">Kaydet</div>
                        </div>
                                    </div>

            <div class="competency-popup-close" onclick="closeCompetencyPopup()">
                <i class="fas fa-times competency-popup-close-icon"></i>
                                </div>
                                </div>
                            </div>

    <!-- Silme Onay Popup -->
    <div id="deletePopup" class="delete-popup" style="display: none;">
        <div class="delete-popup-content">
            <div class="delete-popup-header">
                <div class="delete-popup-title">Yetkinlik Sil</div>
                <div class="delete-popup-close" onclick="closeDeletePopup()">×</div>
                        </div>
            <div class="delete-popup-body">
                <p id="deleteMessage">Bu yetkinlikleri silmek istediğinizden emin misiniz?</p>
                <p class="delete-warning">Bu işlem geri alınamaz!</p>
                                    </div>
            <div class="delete-popup-footer">
                <button class="btn-cancel" onclick="closeDeletePopup()">İptal</button>
                <button class="btn-confirm" onclick="confirmDelete()">Sil</button>
                                </div>
                                </div>
                            </div>

    <!-- Import Popup -->
    <div id="importPopup" class="import-popup" style="display: none;">
        <div class="import-popup-content">
            <div class="import-popup-header">
                <div class="import-popup-title">Excel Import</div>
                <div class="import-popup-close" onclick="closeImportPopup()">×</div>
                        </div>
            <div class="import-popup-body">
                <div class="file-upload-area" onclick="document.getElementById('excelFileInput').click()" 
                     ondrop="handleFileDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                    <div class="file-upload-icon">
                        <i class="fas fa-file-excel"></i>
                                    </div>
                <div class="file-upload-text">Excel dosyasını seçin veya sürükleyin</div>
                <div class="file-upload-subtext">.xlsx, .xls formatları desteklenir</div>
                                </div>
                <input type="file" id="excelFileInput" class="file-input" accept=".xlsx,.xls" onchange="handleFileSelect(event)">
                <div id="selectedFileInfo" class="selected-file" style="display: none;">
                    <div class="file-icon">
                        <i class="fas fa-file-excel"></i>
                                </div>
                    <div class="file-info">
                        <div class="file-name" id="fileName"></div>
                        <div class="file-size" id="fileSize"></div>
                            </div>
                    <div class="remove-file" onclick="removeSelectedFile()">
                        <i class="fas fa-times"></i>
                        </div>
                                    </div>
                <div id="importMessage" class="competency-message" style="display: none; margin-top: 16px;"></div>
                                </div>
            <div class="import-popup-footer">
                <button class="btn-cancel" onclick="closeImportPopup()">İptal</button>
                <button class="btn-import-excel" id="importBtn" onclick="importExcel()" disabled>
                    <i class="fas fa-upload"></i> Import Et
                </button>
            </div>
        </div>
    </div>

    <script src="/js/sidebar.js"></script>
    <script>
        // İşlemler butonları için fonksiyonlar
        function addItem() {
            // Düzenleme modunu sıfırla
            resetEditMode();
            // Form alanlarını temizle
            clearCompetencyForm();
            // Popup'ı aç
            document.getElementById('competencyPopup').style.display = 'flex';
        }
        
        async function editItem() {
            const checkboxes = document.querySelectorAll('#resultsBody input[type="checkbox"]:checked');
            
            if (checkboxes.length !== 1) {
                showMessage('Düzenlemek için sadece bir yetkinlik seçin!', 'error');
                return;
            }
            
            const selectedRow = checkboxes[0].closest('tr');
            const competencyId = selectedRow.getAttribute('data-competency-id');
            
            if (!competencyId) {
                showMessage('Yetkinlik ID bulunamadı!', 'error');
                return;
            }
            
            try {
                // Yetkinlik verilerini getir
                const token = localStorage.getItem('token');
                const response = await fetch(`/api/competency/${competencyId}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Yetkinlik verileri alınamadı');
                }
                
                const result = await response.json();
                if (result.success) {
                    const competency = result.competency;
                    
                    // Form alanlarını doldur
                    document.getElementById('titleInput').value = competency.title;
                    document.getElementById('customerFocusMin').value = competency.customerFocus.min;
                    document.getElementById('customerFocusMax').value = competency.customerFocus.max;
                    document.getElementById('uncertaintyMin').value = competency.uncertaintyManagement.min;
                    document.getElementById('uncertaintyMax').value = competency.uncertaintyManagement.max;
                    document.getElementById('influenceMin').value = competency.influence.min;
                    document.getElementById('influenceMax').value = competency.influence.max;
                    document.getElementById('collaborationMin').value = competency.collaboration.min;
                    document.getElementById('collaborationMax').value = competency.collaboration.max;
                    
                    // Unvan alanını readonly yap
                    document.getElementById('titleInput').readOnly = true;
                    document.getElementById('titleInput').style.backgroundColor = '#f8f9fa';
                    document.getElementById('titleInput').style.color = '#6c757d';
                    
                    // Popup başlığını değiştir
                    document.querySelector('.competency-popup-title').textContent = 'Yetkinlik Düzenle';
                    
                    // Kaydet butonunu güncelle
                    document.querySelector('.competency-save-text').textContent = 'Güncelle';
                    
                    // Popup'ı aç
                    document.getElementById('competencyPopup').style.display = 'flex';
                    
                    // Global değişken olarak düzenlenen ID'yi sakla
                    window.editingCompetencyId = competencyId;
                    
                } else {
                    throw new Error(result.message || 'Yetkinlik verileri alınamadı');
                }
                
            } catch (error) {
                console.error('Yetkinlik verileri alma hatası:', error);
                showMessage('Yetkinlik verileri alınırken bir hata oluştu: ' + error.message, 'error');
            }
        }
        
        function deleteItem() {
            const checkboxes = document.querySelectorAll('#resultsBody input[type="checkbox"]:checked');
            
            if (checkboxes.length === 0) {
                showMessage('Lütfen silmek istediğiniz yetkinliği seçin!', 'error');
                return;
            }
            
            // Seçili yetkinliklerin isimlerini al
            const selectedTitles = [];
            checkboxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const title = row.cells[1].textContent;
                selectedTitles.push(title);
            });
            
            // Popup mesajını güncelle
            const deleteMessage = document.getElementById('deleteMessage');
            if (selectedTitles.length === 1) {
                deleteMessage.textContent = `"${selectedTitles[0]}" yetkinliğini silmek istediğinizden emin misiniz?`;
            } else {
                deleteMessage.textContent = `${selectedTitles.length} yetkinliği silmek istediğinizden emin misiniz?\n\nSeçilen Tercihlerin Unvanları: ${selectedTitles.join(', ')}`;
            }
            
            // Popup'ı aç
            document.getElementById('deletePopup').style.display = 'flex';
        }

        // Popup fonksiyonları
        function closeCompetencyPopup() {
            document.getElementById('competencyPopup').style.display = 'none';
            // Form alanlarını temizle
            clearCompetencyForm();
            // Düzenleme modunu sıfırla
            resetEditMode();
        }

        function resetEditMode() {
            // Düzenleme modunu sıfırla
            window.editingCompetencyId = null;
            
            // Popup başlığını sıfırla
            document.querySelector('.competency-popup-title').textContent = 'Yetkinlik Ekle';
            
            // Kaydet butonunu sıfırla
            document.querySelector('.competency-save-text').textContent = 'Kaydet';
            
            // Unvan alanını normal hale getir
            const titleInput = document.getElementById('titleInput');
            titleInput.readOnly = false;
            titleInput.style.backgroundColor = 'white';
            titleInput.style.color = 'black';
        }

        function clearCompetencyForm() {
            document.getElementById('titleInput').value = '';
            document.getElementById('customerFocusMin').value = '';
            document.getElementById('customerFocusMax').value = '';
            document.getElementById('uncertaintyMin').value = '';
            document.getElementById('uncertaintyMax').value = '';
            document.getElementById('influenceMin').value = '';
            document.getElementById('influenceMax').value = '';
            document.getElementById('collaborationMin').value = '';
            document.getElementById('collaborationMax').value = '';
            hideMessage();
        }

        function showMessage(text, type) {
            const messageDiv = document.getElementById('competencyMessage');
            messageDiv.textContent = text;
            messageDiv.className = `competency-message ${type}`;
            messageDiv.style.display = 'block';
            
            // 3 saniye sonra mesajı gizle
            setTimeout(() => {
                hideMessage();
            }, 3000);
        }

        function hideMessage() {
            const messageDiv = document.getElementById('competencyMessage');
            messageDiv.style.display = 'none';
        }

        // Silme popup fonksiyonları
        function closeDeletePopup() {
            document.getElementById('deletePopup').style.display = 'none';
        }

        async function confirmDelete() {
            const checkboxes = document.querySelectorAll('#resultsBody input[type="checkbox"]:checked');
            
            try {
                const token = localStorage.getItem('token');
                let successCount = 0;
                let errorCount = 0;
                
                // Her seçili yetkinliği sil
                for (const checkbox of checkboxes) {
                    const row = checkbox.closest('tr');
                    const competencyId = row.getAttribute('data-competency-id');
                    
                    if (!competencyId) {
                        errorCount++;
                        continue;
                    }
                    
                    try {
                        const response = await fetch(`/api/competency/${competencyId}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${token}`
                            }
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            if (result.success) {
                                successCount++;
                            } else {
                                errorCount++;
                            }
                        } else {
                            errorCount++;
                        }
                    } catch (error) {
                        console.error('Yetkinlik silme hatası:', error);
                        errorCount++;
                    }
                }
                
                // Popup'ı kapat
                closeDeletePopup();
                
                // Sonuç mesajı göster
                if (errorCount === 0) {
                    showMessage(`${successCount} yetkinlik başarıyla silindi!`, 'success');
                } else if (successCount === 0) {
                    showMessage('Yetkinlikler silinirken bir hata oluştu!', 'error');
                } else {
                    showMessage(`${successCount} yetkinlik silindi, ${errorCount} yetkinlik silinemedi!`, 'error');
                }
                
                // Verileri yenile
                loadCompetencies();
                
            } catch (error) {
                console.error('Silme işlemi hatası:', error);
                showMessage('Silme işlemi sırasında bir hata oluştu!', 'error');
                closeDeletePopup();
            }
        }

        // Checkbox durumuna göre butonları güncelle
        function updateButtonStates() {
            const checkboxes = document.querySelectorAll('#resultsBody input[type="checkbox"]');
            const editBtn = document.getElementById('editBtn');
            const deleteBtn = document.getElementById('deleteBtn');
            
            // Seçili checkbox'ları say
            let checkedCount = 0;
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    checkedCount++;
                }
            });
            
            // Düzenle butonu: sadece 1 seçim varsa aktif
            editBtn.disabled = checkedCount !== 1;
            
            // Sil butonu: en az 1 seçim varsa aktif
            deleteBtn.disabled = checkedCount === 0;
        }

        async function saveCompetency() {
            // Form verilerini al
            const title = document.getElementById('titleInput') ? document.getElementById('titleInput').value.trim() : 'Yeni Unvan';
            const customerFocusMin = document.getElementById('customerFocusMin').value;
            const customerFocusMax = document.getElementById('customerFocusMax').value;
            const uncertaintyMin = document.getElementById('uncertaintyMin').value;
            const uncertaintyMax = document.getElementById('uncertaintyMax').value;
            const influenceMin = document.getElementById('influenceMin').value;
            const influenceMax = document.getElementById('influenceMax').value;
            const collaborationMin = document.getElementById('collaborationMin').value;
            const collaborationMax = document.getElementById('collaborationMax').value;

            // Validasyon
            if (!title || !customerFocusMin || !customerFocusMax || !uncertaintyMin || !uncertaintyMax || 
                !influenceMin || !influenceMax || !collaborationMin || !collaborationMax) {
                showMessage('Lütfen tüm alanları doldurun!', 'error');
                return;
            }

            // Değer aralığı kontrolü (1-100 arası)
            const rangeErrors = [];
            const competencyFields = [
                { name: 'Müşteri Odaklılık', min: customerFocusMin, max: customerFocusMax },
                { name: 'Belirsizlik Yönetimi', min: uncertaintyMin, max: uncertaintyMax },
                { name: 'İnsanları Etkileme', min: influenceMin, max: influenceMax },
                { name: 'Güven Veren İşbirlikçi ve Sinerji', min: collaborationMin, max: collaborationMax }
            ];

            competencyFields.forEach(field => {
                if (parseInt(field.min) < 1 || parseInt(field.min) > 100 || 
                    parseInt(field.max) < 1 || parseInt(field.max) > 100) {
                    rangeErrors.push(field.name);
                }
            });

            if (rangeErrors.length > 0) {
                const errorText = rangeErrors.length === 1 
                    ? `1 ile 100 arasında bir veri girmeniz gerekiyor! (${rangeErrors[0]})`
                    : `1 ile 100 arasında bir veri girmeniz gerekiyor! (${rangeErrors.join(', ')})`;
                showMessage(errorText, 'error');
                return;
            }

            // Min-Max değerlerini kontrol et ve hangi alanlarda hata olduğunu belirle
            const errors = [];
            
            if (parseInt(customerFocusMin) > parseInt(customerFocusMax)) {
                errors.push('Müşteri Odaklılık');
            }
            if (parseInt(uncertaintyMin) > parseInt(uncertaintyMax)) {
                errors.push('Belirsizlik Yönetimi');
            }
            if (parseInt(influenceMin) > parseInt(influenceMax)) {
                errors.push('İnsanları Etkileme');
            }
            if (parseInt(collaborationMin) > parseInt(collaborationMax)) {
                errors.push('Güven Veren İşbirlikçi ve Sinerji');
            }
            
            if (errors.length > 0) {
                const errorText = errors.length === 1 
                    ? `Minimum değer maksimum değerden büyük olamaz! (${errors[0]})`
                    : `Minimum değer maksimum değerden büyük olamaz! (${errors.join(', ')})`;
                showMessage(errorText, 'error');
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const competencyData = {
                    title,
                    customerFocusMin,
                    customerFocusMax,
                    uncertaintyMin,
                    uncertaintyMax,
                    influenceMin,
                    influenceMax,
                    collaborationMin,
                    collaborationMax
                };

                let response;
                let isEditMode = window.editingCompetencyId;
                
                if (isEditMode) {
                    // Düzenleme modu
                    response = await fetch(`/api/competency/${window.editingCompetencyId}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(competencyData)
                    });
                } else {
                    // Ekleme modu
                    response = await fetch('/api/competency', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(competencyData)
                    });
                }
                
                if (!response.ok) {
                    throw new Error(isEditMode ? 'Yetkinlik güncellenemedi' : 'Yetkinlik eklenemedi');
                }
                
                const result = await response.json();
                if (result.success) {
                    // Başarı mesajı göster
                    const message = isEditMode ? 'Yetkinlik başarıyla güncellendi!' : 'Yetkinlik başarıyla eklendi!';
                    showMessage(message, 'success');
                    
                    // 1.5 saniye sonra popup'ı kapat ve verileri yenile
                    setTimeout(() => {
                        closeCompetencyPopup();
                        loadCompetencies();
                    }, 1500);
                } else {
                    throw new Error(result.message || (isEditMode ? 'Yetkinlik güncellenirken bir hata oluştu' : 'Yetkinlik eklenirken bir hata oluştu'));
                }
                
            } catch (error) {
                console.error('Yetkinlik işlemi hatası:', error);
                const errorMessage = window.editingCompetencyId ? 'Yetkinlik güncellenirken bir hata oluştu: ' : 'Yetkinlik eklenirken bir hata oluştu: ';
                showMessage(errorMessage + error.message, 'error');
            }
        }

        // Import popup fonksiyonları
        function openImportPopup() {
            document.getElementById('importPopup').style.display = 'flex';
            hideImportMessage();
        }

        function closeImportPopup() {
            document.getElementById('importPopup').style.display = 'none';
            removeSelectedFile();
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                displaySelectedFile(file);
            }
        }

        function handleFileDrop(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                    displaySelectedFile(file);
                    document.getElementById('excelFileInput').files = files;
                } else {
                    showImportMessage('Lütfen sadece Excel dosyası (.xlsx, .xls) seçin!', 'error');
                }
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
        }

        function displaySelectedFile(file) {
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            document.getElementById('selectedFileInfo').style.display = 'flex';
            document.getElementById('importBtn').disabled = false;
            hideImportMessage();
        }

        function removeSelectedFile() {
            document.getElementById('excelFileInput').value = '';
            document.getElementById('selectedFileInfo').style.display = 'none';
            document.getElementById('importBtn').disabled = true;
            hideImportMessage();
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showImportMessage(text, type) {
            const messageDiv = document.getElementById('importMessage');
            messageDiv.textContent = text;
            messageDiv.className = `competency-message ${type}`;
            messageDiv.style.display = 'block';
        }

        function hideImportMessage() {
            const messageDiv = document.getElementById('importMessage');
            messageDiv.style.display = 'none';
        }

        async function importExcel() {
            const fileInput = document.getElementById('excelFileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                showImportMessage('Lütfen bir Excel dosyası seçin!', 'error');
                return;
            }

            try {
                const token = localStorage.getItem('token');
                const formData = new FormData();
                formData.append('excelFile', file);

                // Import butonunu disable et
                const importBtn = document.getElementById('importBtn');
                importBtn.disabled = true;
                importBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Import Ediliyor...';

                const response = await fetch('/api/competency/import', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    let message = `Başarıyla ${result.importedCount} yetkinlik import edildi!`;
                    if (result.errors && result.errors.length > 0) {
                        message += `\n\nHatalar:\n${result.errors.slice(0, 5).join('\n')}`;
                        if (result.errors.length > 5) {
                            message += `\n... ve ${result.errors.length - 5} hata daha`;
                        }
                    }
                    showImportMessage(message, 'success');
                    
                    // 3 saniye sonra popup'ı kapat ve verileri yenile
                    setTimeout(() => {
                        closeImportPopup();
                        loadCompetencies();
                    }, 3000);
                } else {
                    let errorMessage = result.message || 'Import işlemi başarısız!';
                    if (result.errors && result.errors.length > 0) {
                        errorMessage += `\n\nHatalar:\n${result.errors.slice(0, 5).join('\n')}`;
                        if (result.errors.length > 5) {
                            errorMessage += `\n... ve ${result.errors.length - 5} hata daha`;
                        }
                    }
                    showImportMessage(errorMessage, 'error');
                }

            } catch (error) {
                console.error('Import hatası:', error);
                showImportMessage('Import işlemi sırasında bir hata oluştu: ' + error.message, 'error');
            } finally {
                // Import butonunu tekrar aktif et
                const importBtn = document.getElementById('importBtn');
                importBtn.disabled = false;
                importBtn.innerHTML = '<i class="fas fa-upload"></i> Import Et';
            }
        }

        // Sayfa yüklendiğinde buton durumlarını güncelle ve verileri yükle
        document.addEventListener('DOMContentLoaded', function() {
            updateButtonStates();
            loadCompetencies();
        });

        // Yetkinlikleri yükle
        async function loadCompetencies() {
            try {
                const token = localStorage.getItem('token');
                const response = await fetch('/api/competency', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Yetkinlik listesi yüklenemedi');
                }
                
                const result = await response.json();
                if (result.success) {
                    displayCompetencies(result.competencies);
                } else {
                    throw new Error(result.message || 'Yetkinlik listesi alınamadı');
                }
            } catch (error) {
                console.error('Yetkinlik listesi yükleme hatası:', error);
                document.getElementById('resultsBody').innerHTML = '<tr><td colspan="6" style="text-align: center; color: #dc3545;">Veriler yüklenemedi</td></tr>';
            }
        }

        // Yetkinlikleri tabloda göster
        function displayCompetencies(competencies) {
            const tableBody = document.getElementById('resultsBody');
            tableBody.innerHTML = '';
            
            if (competencies.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: #8A92A6;">Henüz yetkinlik bulunmuyor</td></tr>';
                return;
            }
            
            competencies.forEach(competency => {
                const row = document.createElement('tr');
                row.setAttribute('data-competency-id', competency._id);
                row.innerHTML = `
                    <td>
                        <label class="custom-checkbox">
                            <input type="checkbox" onchange="updateButtonStates()">
                            <span class="checkmark"></span>
                        </label>
                    </td>
                    <td>${competency.title}</td>
                    <td>${competency.customerFocus.min}-${competency.customerFocus.max}</td>
                    <td>${competency.uncertaintyManagement.min}-${competency.uncertaintyManagement.max}</td>
                    <td>${competency.influence.min}-${competency.influence.max}</td>
                    <td>${competency.collaboration.min}-${competency.collaboration.max}</td>
                `;
                tableBody.appendChild(row);
            });
        }
    </script>
</body>
</html> 